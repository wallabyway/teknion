!function(){"use strict";function a(a,b){Autodesk.Viewing.Extension.call(this,a,b),this.active=!1,this.groups=[],this.geometries=[],this.materials=[],this.lines=[],this.lightPreset=4,this.viewerLightPreset=4,this.showingSolidMaterials=!0,this.showingLines=!0,this.linesMaterial=new THREE.LineBasicMaterial({color:new THREE.Color(0),opacity:.03,transparent:!0,depthTest:!0,depthWrite:!1}),this.solidMaterial=new THREE.MeshPhongMaterial({color:4291809231,specular:0,emissive:4291809231,ambient:0,opacity:1,transparent:!1,polygonOffset:!0,polygonOffsetFactor:1,polygonOffsetUnits:5}),this.solidMaterial.packedNormals=!0}function b(a,b,c,d,e){var g=a.getData().instanceTree,h=a.getFragmentList(),i=[];g.enumNodeChildren(a.getRootId(),function(a){g.isNodeHidden(a)||g.isNodeOff(a)||g.enumNodeFragments(a,function(a){var c=h.getVizmesh(a);if(c.geometry&&!c.geometry.is2d&&!c.geometry.isLines&&c.material.cutplanes){d.push({fragment:a,fragments:h,material:h.getMaterial(a)});var e=h.getGeometry(a);if(!f(e,a,b)){var g=new THREE.Matrix4;h.getWorldMatrix(a,g),i.push({geometry:e,world:g,fragment:a})}}}.bind(this),!1)},!0);for(var j=new THREE.Group,k=i.length,l=new THREE.Vector3,m=new THREE.Quaternion,n=new THREE.Vector3,o=0;o<k;++o){for(var p=new THREE.Geometry,q=p.vertices,r=i[o].world,s=i[o].geometry,t=s.vb,u=s.ib,v=s.vbstride,w=0;w<u.length;){var x=u[w++]*v,y=u[w++]*v,z=u[w++]*v,A=new THREE.Vector3(t[x++],t[x++],t[x]),B=new THREE.Vector3(t[y++],t[y++],t[y]),C=new THREE.Vector3(t[z++],t[z++],t[z]);q.push(A),q.push(B),q.push(B),q.push(C),q.push(C),q.push(A)}var D=new THREE.Line(p,e,THREE.LinePieces);r.decompose(l,m,n),D.position.copy(l),D.quaternion.copy(m),D.scale.copy(n),c.push(D),j.add(D),b.push(i[o])}return j}function c(a,b){for(var c=b.length,d=0;d<c;++d)a.impl.sceneAfter.add(b[d]);a.impl.invalidate(!0,!0,!0)}function d(a,b){for(var c=b.length,d=0;d<c;++d){var e=b[d];e.fragments.setMaterial(e.fragment,e.material)}a.impl.invalidate(!0,!0,!0)}function e(a,b){for(var c=b.length,d=0;d<c;++d)a.impl.sceneAfter.remove(b[d]);a.impl.invalidate(!0,!0,!0)}function f(a,b,c){for(var d=c.length,e=0;e<d;++e)if(c[e].geometry===a&&c[e].fragment===b)return c[e];return null}AutodeskNamespace("Autodesk.Viewing.Extensions.Wireframes"),a.prototype=Object.create(Autodesk.Viewing.Extension.prototype),a.prototype.constructor=a;var g=a.prototype;g.load=function(){var a=function(){var a=this.viewer.impl.getMaterials();a&&a.togglePolygonOffset&&a.togglePolygonOffset(!0,1,5)}.bind(this),d=function(){for(var d=this.viewer,e=d.impl.modelQueue().getModels(),f=e.length,g=0;g<f;++g)if(e[g].getData().instanceTree){var h=b(e[g],this.geometries,this.lines,this.materials,this.linesMaterial);h.model=e[g],this.groups.push(h),this.active&&(c(this.viewer,this.groups),this.setSolidMaterial(this.solidMaterial))}a(),d.impl.invalidate(!0,!0,!0)}.bind(this);return d(),this.viewer.addEventListener(Autodesk.Viewing.PROGRESS_UPDATE_EVENT,function(a){a.state===Autodesk.Viewing.ProgressState.LOADING&&d()}),a(),!0},g.unload=function(){return this.active=!1,d(this.viewer,this.materials),e(this.viewer,this.groups),this.geometries=[],this.materials=[],this.lines=[],this.groups=[],!0},g.activate=function(){this.active=!0,this.viewerLightPreset=this.viewer.prefs.get("lightPreset"),this.viewer.setLightPreset(this.lightPreset),this.setSolidMaterial(this.solidMaterial),this.setLinesMaterial(this.linesMaterial),c(this.viewer,this.groups),this.showSolidMaterial(this.showingSolidMaterials),this.showLines(this.showingLines)},g.deactivate=function(){this.active=!1,this.viewer.setLightPreset(this.viewerLightPreset),e(this.viewer,this.groups),d(this.viewer,this.materials)},g.showSolidMaterial=function(a){this.showingSolidMaterials=a,this.active&&(this.showingSolidMaterials?this.setSolidMaterial(this.solidMaterial):d(this.viewer,this.materials))},g.showLines=function(a){if(this.showingLines=a,this.active){for(var b=this.lines,c=b.length,d=0;d<c;++d){b[d].visible=a}this.viewer.impl.invalidate(!0,!0,!0)}},g.setSolidMaterial=function(a){if(this.solidMaterial=a,this.active&&this.showingSolidMaterials){for(var b=this.materials,c=b.length,d=0;d<c;++d){var a=b[d];a.fragments.setMaterial(a.fragment,this.solidMaterial)}this.viewer.impl.invalidate(!0,!0,!0)}},g.setLinesMaterial=function(a){if(this.linesMaterial=a,this.active&&this.showingLines){for(var b=this.lines,c=b.length,d=0;d<c;++d){b[d].material=this.linesMaterial}this.viewer.impl.invalidate(!0,!0,!0)}},g.setLightPreset=function(a){this.lightPreset=a,this.active&&this.viewer.setLightPreset(a)},Autodesk.Viewing.theExtensionManager.registerExtension("Autodesk.Viewing.Wireframes",a)}();